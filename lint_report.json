[{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\App.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\Desktop3\\debate_mfxb\\mock-court\\src\\App.tsx:72:47\n  70 |     // --- Evidence Sync ---\n  71 |     useEffect(() => {\n> 72 |         if (selectedRole === 'Prosecutor AI') setNewEvidenceSpeaker('原告律师');\n     |                                               ^^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  73 |         else if (selectedRole === 'Defense AI') setNewEvidenceSpeaker('被告律师');\n  74 |     }, [selectedRole]);\n  75 |","line":72,"column":47,"nodeType":null,"endLine":72,"endColumn":68}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport DraggableWindow from './components/DraggableWindow';\r\nimport LeftSidebar from './features/LeftSidebar';\r\nimport ChatArea from './features/ChatArea';\r\nimport RightSidebar from './features/RightSidebar';\r\nimport { useCourtSession, ROLE_MAPPINGS } from './hooks/useCourtSession';\r\nimport { useWindowManager } from './hooks/useWindowManager';\r\nimport type {\r\n    TextEvidence,\r\n    FileEvidence,\r\n    UserRole,\r\n    LayoutConfig,\r\n    CaseDataConfig,\r\n    EvidenceDataConfig,\r\n    NewEvidenceInputConfig,\r\n    SessionInfoConfig\r\n} from './types';\r\n\r\n// --- Main Application ---\r\nexport default function MockCourtApp(): React.ReactElement {\r\n    // --- Session Hook (single line to access all session logic) ---\r\n    const { sessionState, actions } = useCourtSession();\r\n\r\n    // Destructure for convenience\r\n    const {\r\n        messages, isConnected, isConnecting, sessionId,\r\n        currentPhase, currentSpeaker, activeNode, isTurnToSpeak, logs\r\n    } = sessionState;\r\n\r\n    const { connect, sendMessage, requestNextStep } = actions;\r\n\r\n    // --- Window Manager Hook ---\r\n    const { windows, windowActions, inputWindow, inputWindowActions } = useWindowManager();\r\n\r\n    // --- UI State (local to this component) ---\r\n    const [leftWidth, setLeftWidth] = useState<number>(320);\r\n    const [rightWidth, setRightWidth] = useState<number>(300);\r\n\r\n    const [roleFilter, setRoleFilter] = useState<string>('all');\r\n    const [evidenceFilter, setEvidenceFilter] = useState<string>('all');\r\n    const [selectedRole, setSelectedRole] = useState<UserRole>('Prosecutor AI');\r\n\r\n    // Inputs\r\n    const [inputValue, setInputValue] = useState<string>('');\r\n    const [caseContext, setCaseContext] = useState<string>(\"张三（原告）诉李四（被告）民间借贷纠纷一案...\");\r\n    const [textEvidence, setTextEvidence] = useState<TextEvidence[]>([{ speaker: '原告律师', content: '微信聊天记录：被告承诺\"下周还钱\"' }]);\r\n    const [fileEvidence, setFileEvidence] = useState<FileEvidence[]>([{ speaker: '原告律师', name: '转账记录.pdf', type: 'pdf', url: null }]);\r\n    const [newEvidenceInput, setNewEvidenceInput] = useState<string>('');\r\n    const [newEvidenceSpeaker, setNewEvidenceSpeaker] = useState<string>('原告律师');\r\n\r\n    const [inputHeight, setInputHeight] = useState<number>(120);\r\n    const [isLongFormMode, setIsLongFormMode] = useState<boolean>(false);\r\n\r\n    // --- Actions (using hook functions) ---\r\n    const handleStartTrial = useCallback((): void => {\r\n        connect(selectedRole, caseContext, textEvidence, fileEvidence);\r\n    }, [connect, selectedRole, caseContext, textEvidence, fileEvidence]);\r\n\r\n    const handleNextStep = useCallback((): void => {\r\n        requestNextStep();\r\n    }, [requestNextStep]);\r\n\r\n    const handleSendMessage = useCallback((): void => {\r\n        const success = sendMessage(inputValue, selectedRole);\r\n        if (success) {\r\n            setInputValue('');\r\n        }\r\n    }, [sendMessage, inputValue, selectedRole]);\r\n\r\n    // --- Evidence Sync ---\r\n    useEffect(() => {\r\n        if (selectedRole === 'Prosecutor AI') setNewEvidenceSpeaker('原告律师');\r\n        else if (selectedRole === 'Defense AI') setNewEvidenceSpeaker('被告律师');\r\n    }, [selectedRole]);\r\n\r\n    // Evidence Handling (memoized)\r\n    const deleteEvidence = useCallback((index: number, isFile: boolean): void => {\r\n        if (window.confirm(\"Are you sure you want to remove this evidence?\")) {\r\n            if (isFile) setFileEvidence(prev => prev.filter((_, i) => i !== index));\r\n            else setTextEvidence(prev => prev.filter((_, i) => i !== index));\r\n        }\r\n    }, []);\r\n\r\n    const handleTextEvidenceEdit = useCallback((index: number, value: string): void => {\r\n        setTextEvidence(prev => {\r\n            const newArr = [...prev];\r\n            newArr[index] = { ...newArr[index], content: value };\r\n            return newArr;\r\n        });\r\n    }, []);\r\n\r\n    const handleAddTextEvidence = useCallback((evidence: TextEvidence): void => {\r\n        setTextEvidence(prev => [...prev, evidence]);\r\n    }, []);\r\n\r\n    const handleAddFileEvidence = useCallback((evidence: FileEvidence): void => {\r\n        setFileEvidence(prev => [...prev, evidence]);\r\n    }, []);\r\n\r\n    // --- Layout Resizing ---\r\n    type ResizeDirection = 'left' | 'right' | 'input';\r\n\r\n    const startResizing = useCallback((direction: ResizeDirection) => (e: React.MouseEvent): void => {\r\n        e.preventDefault();\r\n        const startX = e.clientX;\r\n        const startY = e.clientY;\r\n        const startW = direction === 'left' ? leftWidth : rightWidth;\r\n        const startH = inputHeight;\r\n\r\n        const onMove = (ev: MouseEvent): void => {\r\n            if (direction === 'left' || direction === 'right') {\r\n                const d = ev.clientX - startX;\r\n                if (direction === 'left') setLeftWidth(Math.max(250, Math.min(600, startW + d)));\r\n                else setRightWidth(Math.max(250, Math.min(500, startW - d)));\r\n            } else if (direction === 'input') {\r\n                const d = ev.clientY - startY;\r\n                setInputHeight(Math.max(80, Math.min(600, startH - d)));\r\n            }\r\n        };\r\n\r\n        const onUp = (): void => {\r\n            document.removeEventListener('mousemove', onMove);\r\n            document.removeEventListener('mouseup', onUp);\r\n        };\r\n\r\n        document.addEventListener('mousemove', onMove);\r\n        document.addEventListener('mouseup', onUp);\r\n    }, [leftWidth, rightWidth, inputHeight]);\r\n\r\n    // --- Memoized Props for LeftSidebar (Performance Optimization) ---\r\n    const leftLayoutConfig: LayoutConfig = useMemo(() => ({\r\n        width: leftWidth,\r\n        onStartResize: startResizing('left')\r\n    }), [leftWidth, startResizing]);\r\n\r\n    const caseDataConfig: CaseDataConfig = useMemo(() => ({\r\n        context: caseContext,\r\n        onChange: setCaseContext\r\n    }), [caseContext]);\r\n\r\n    const evidenceDataConfig: EvidenceDataConfig = useMemo(() => ({\r\n        file: fileEvidence,\r\n        text: textEvidence,\r\n        filter: evidenceFilter as 'all' | '原告律师' | '被告律师',\r\n        onFilterChange: setEvidenceFilter,\r\n        onDelete: deleteEvidence,\r\n        onOpen: windowActions.open,\r\n        onTextEdit: handleTextEvidenceEdit\r\n    }), [fileEvidence, textEvidence, evidenceFilter, deleteEvidence, windowActions.open, handleTextEvidenceEdit]);\r\n\r\n    const newEvidenceInputConfig: NewEvidenceInputConfig = useMemo(() => ({\r\n        value: newEvidenceInput,\r\n        onChange: setNewEvidenceInput,\r\n        speaker: newEvidenceSpeaker,\r\n        onSpeakerChange: setNewEvidenceSpeaker,\r\n        onAddText: handleAddTextEvidence,\r\n        onAddFile: handleAddFileEvidence\r\n    }), [newEvidenceInput, newEvidenceSpeaker, handleAddTextEvidence, handleAddFileEvidence]);\r\n\r\n    const sessionInfoConfig: SessionInfoConfig = useMemo(() => ({\r\n        isConnected,\r\n        isTurnToSpeak,\r\n        logs,\r\n        selectedRole\r\n    }), [isConnected, isTurnToSpeak, logs, selectedRole]);\r\n\r\n\r\n    return (\r\n        <div className=\"flex h-screen w-full bg-surface-container-low font-sans text-on-surface overflow-hidden relative selection:bg-primary-container selection:text-on-primary-container\">\r\n\r\n            {/* Windows Layer */}\r\n            {windows.map(win => (\r\n                <DraggableWindow\r\n                    key={win.id}\r\n                    win={win}\r\n                    onClose={windowActions.close}\r\n                    onFocus={windowActions.focus}\r\n                    updatePosition={windowActions.updatePosition}\r\n                    updateSize={windowActions.updateSize}\r\n                />\r\n            ))}\r\n\r\n            {/* LEFT SIDEBAR */}\r\n            <LeftSidebar\r\n                layout={leftLayoutConfig}\r\n                caseData={caseDataConfig}\r\n                evidenceData={evidenceDataConfig}\r\n                newEvidenceInput={newEvidenceInputConfig}\r\n                sessionInfo={sessionInfoConfig}\r\n            />\r\n\r\n            {/* CENTER (Chat) */}\r\n            <ChatArea\r\n                messages={messages}\r\n                roleFilter={roleFilter}\r\n                onRoleFilterChange={setRoleFilter}\r\n                currentPhase={currentPhase}\r\n                currentSpeaker={currentSpeaker}\r\n                sessionId={sessionId}\r\n                isConnected={isConnected}\r\n                inputValue={inputValue}\r\n                onInputChange={setInputValue}\r\n                onSendMessage={handleSendMessage}\r\n                isTurnToSpeak={isTurnToSpeak}\r\n                isLongFormMode={isLongFormMode}\r\n                onExpandInput={() => setIsLongFormMode(true)}\r\n                onCloseLongForm={() => setIsLongFormMode(false)}\r\n                selectedRole={selectedRole}\r\n                inputWindowState={inputWindow}\r\n                onFocusInputWindow={inputWindowActions.focus}\r\n                onUpdateInputWindowPos={inputWindowActions.updatePosition}\r\n                onUpdateInputWindowSize={inputWindowActions.updateSize}\r\n            />\r\n\r\n            {/* RIGHT SIDEBAR */}\r\n            <RightSidebar\r\n                width={rightWidth}\r\n                onStartResize={startResizing('right')}\r\n                selectedRole={selectedRole}\r\n                onRoleChange={setSelectedRole}\r\n                roleOptions={Object.keys(ROLE_MAPPINGS) as UserRole[]}\r\n                isConnected={isConnected}\r\n                isConnecting={isConnecting}\r\n                isTurnToSpeak={isTurnToSpeak}\r\n                currentPhase={currentPhase}\r\n                activeNode={activeNode}\r\n                onStartTrial={handleStartTrial}\r\n                onNextStep={handleNextStep}\r\n            />\r\n\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\CourtClient.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[157,160],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[157,160],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[200,203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[200,203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[243,246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[243,246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[292,295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[292,295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[334,337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[334,337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[371,374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[371,374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[497,500],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[497,500],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { TextEvidence, FileEvidence, UserRole } from './types';\r\n\r\ninterface CourtClientCallbacks {\r\n    onOpen?: () => void;\r\n    onConnected?: (data: any) => void;\r\n    onStatusUpdate?: (data: any) => void;\r\n    onDebateUpdate?: (data: any) => void;\r\n    onHumanInputRequired?: (data: any) => void;\r\n    onDebateEnded?: (data: any) => void;\r\n    onError?: (error: any) => void;\r\n    onClose?: () => void;\r\n}\r\n\r\ninterface CreateSessionResponse {\r\n    session_id: string;\r\n    [key: string]: any;\r\n}\r\n\r\nexport class CourtClient {\r\n    private baseUrl: string;\r\n    private ws: WebSocket | null;\r\n    public sessionId: string | null;\r\n\r\n    constructor(baseUrl: string = 'http://localhost:8000') {\r\n        this.baseUrl = baseUrl;\r\n        this.ws = null;\r\n        this.sessionId = null;\r\n    }\r\n\r\n    // Create new session\r\n    async createSession(\r\n        caseInfo: string,\r\n        caseEvidence: (TextEvidence | FileEvidence)[] = [],\r\n        humanRole: UserRole | null = null\r\n    ): Promise<CreateSessionResponse> {\r\n        try {\r\n            const response = await fetch(`${this.baseUrl}/api/sessions`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    case_info: caseInfo,\r\n                    case_evidence: caseEvidence,\r\n                    human_role: humanRole\r\n                })\r\n            });\r\n\r\n            if (!response.ok) throw new Error(`Failed to create session: ${response.status}`);\r\n\r\n            const data = await response.json();\r\n            this.sessionId = data.session_id;\r\n            return data;\r\n        } catch (error) {\r\n            console.error('Session creation error:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // Connect to WebSocket\r\n    connectWebSocket(role: UserRole | string | null = null, callbacks: CourtClientCallbacks = {}): WebSocket {\r\n        if (!this.sessionId) throw new Error('No active session');\r\n\r\n        const wsUrl = `ws://${this.baseUrl.replace(/^http(s?):\\/\\//, '')}/ws/${this.sessionId}`;\r\n        const url = role ? `${wsUrl}?role=${encodeURIComponent(role)}` : wsUrl;\r\n\r\n        this.ws = new WebSocket(url);\r\n\r\n        this.ws.onopen = () => {\r\n            if (callbacks.onOpen) callbacks.onOpen();\r\n        };\r\n\r\n        this.ws.onmessage = (event: MessageEvent) => {\r\n            try {\r\n                const message = JSON.parse(event.data);\r\n                switch (message.event) {\r\n                    case 'connected':\r\n                        callbacks.onConnected?.(message.data);\r\n                        break;\r\n                    case 'status_update':\r\n                        callbacks.onStatusUpdate?.(message.data);\r\n                        break;\r\n                    case 'debate_update':\r\n                        callbacks.onDebateUpdate?.(message.data);\r\n                        break;\r\n                    case 'human_input_required':\r\n                        callbacks.onHumanInputRequired?.(message.data);\r\n                        break;\r\n                    case 'debate_ended':\r\n                        callbacks.onDebateEnded?.(message.data);\r\n                        break;\r\n                    case 'error':\r\n                        callbacks.onError?.(message.data);\r\n                        break;\r\n                    default:\r\n                        console.log('Unknown event:', message);\r\n                }\r\n            } catch (e) {\r\n                console.error('WebSocket message parse error:', e);\r\n            }\r\n        };\r\n\r\n        this.ws.onclose = () => {\r\n            if (callbacks.onClose) callbacks.onClose();\r\n        };\r\n\r\n        this.ws.onerror = (err: Event) => {\r\n            if (callbacks.onError) callbacks.onError(err);\r\n        }\r\n\r\n        return this.ws;\r\n    }\r\n\r\n    // Send human input\r\n    sendHumanInput(content: string, role?: string): void {\r\n        if (!this.ws || this.ws.readyState !== WebSocket.OPEN) throw new Error('WebSocket not connected');\r\n        this.ws.send(JSON.stringify({\r\n            event: 'human_input',\r\n            data: { content, role }\r\n        }));\r\n    }\r\n\r\n    // Request next step (AI mode)\r\n    requestNextStep(): void {\r\n        if (!this.ws || this.ws.readyState !== WebSocket.OPEN) throw new Error('WebSocket not connected');\r\n        this.ws.send(JSON.stringify({\r\n            event: 'next_step',\r\n            data: {}\r\n        }));\r\n    }\r\n\r\n    // End session\r\n    async endSession(): Promise<void> {\r\n        if (!this.sessionId) return;\r\n        try {\r\n            await fetch(`${this.baseUrl}/api/sessions/${this.sessionId}`, { method: 'DELETE' });\r\n        } catch (e) {\r\n            console.error('End session error:', e);\r\n        }\r\n        if (this.ws) {\r\n            this.ws.close();\r\n            this.ws = null;\r\n        }\r\n        this.sessionId = null;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\Avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\Badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\DetailedInputWindow.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\DraggableWindow.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\EvidenceItem.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TextEvidence' is defined but never used.","line":3,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":27,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TextEvidence"},"fix":{"range":[107,120],"text":""},"desc":"Remove unused variable \"TextEvidence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'FileEvidence' is defined but never used.","line":3,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":41,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileEvidence"},"fix":{"range":[119,133],"text":""},"desc":"Remove unused variable \"FileEvidence\"."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { X, FileText, Image as ImageIcon } from 'lucide-react';\r\nimport type { TextEvidence, FileEvidence, EvidenceType } from '../types';\r\n\r\n/** Evidence item type */\r\nexport type EvidenceItemType = 'file' | 'text';\r\n\r\n/** File evidence data for EvidenceItem */\r\nexport interface FileEvidenceData {\r\n    name: string;\r\n    type: EvidenceType;\r\n    url: string | null;\r\n    speaker: string;\r\n}\r\n\r\n/** Text evidence data for EvidenceItem */\r\nexport interface TextEvidenceData {\r\n    content: string;\r\n    speaker: string;\r\n}\r\n\r\n/** EvidenceItem component props */\r\nexport interface EvidenceItemProps {\r\n    /** Type of evidence */\r\n    type: EvidenceItemType;\r\n    /** Evidence data */\r\n    data: FileEvidenceData | TextEvidenceData;\r\n    /** Index in the evidence array */\r\n    index: number;\r\n    /** Whether editing/deletion is disabled */\r\n    disabled: boolean;\r\n    /** Callback when delete button is clicked */\r\n    onDelete: (index: number, isFile: boolean) => void;\r\n    /** Callback when item is clicked to open in window */\r\n    onOpen: (title: string, content: string, type?: string, url?: string | null) => void;\r\n    /** Callback for text evidence content changes (text only) */\r\n    onEdit?: (index: number, value: string) => void;\r\n}\r\n\r\n/**\r\n * EvidenceItem - Unified component for rendering both file and text evidence.\r\n * Eliminates DRY violation by handling both types with shared styling.\r\n */\r\nconst EvidenceItem: React.FC<EvidenceItemProps> = ({\r\n    type,\r\n    data,\r\n    index,\r\n    disabled,\r\n    onDelete,\r\n    onOpen,\r\n    onEdit\r\n}) => {\r\n    const isFile = type === 'file';\r\n    const speakerClass = data.speaker === '原告律师'\r\n        ? 'bg-prosecutor text-prosecutor-text'\r\n        : 'bg-defense text-defense-text';\r\n\r\n    if (isFile) {\r\n        const fileData = data as FileEvidenceData;\r\n        return (\r\n            <div\r\n                onClick={() => onOpen(fileData.name, fileData.name, fileData.type, fileData.url)}\r\n                className=\"flex flex-col gap-2 p-3 rounded-xl bg-surface-container-high hover:bg-surface-container-highest cursor-pointer transition-all hover:shadow-sm group relative overflow-hidden\"\r\n            >\r\n                <div className=\"flex items-center gap-3 relative z-10\">\r\n                    <div className=\"h-10 w-10 rounded-lg bg-surface-container-highest flex items-center justify-center shrink-0 text-primary\">\r\n                        {fileData.type === 'image' ? <ImageIcon size={18} /> : <FileText size={18} />}\r\n                    </div>\r\n                    <span className=\"text-sm font-medium truncate flex-1 text-on-surface\">{fileData.name}</span>\r\n                    <button\r\n                        disabled={disabled}\r\n                        onClick={(e) => { e.stopPropagation(); onDelete(index, true); }}\r\n                        className=\"opacity-0 group-hover:opacity-100 text-on-surface-variant hover:text-error transition-all disabled:hidden\"\r\n                    >\r\n                        <X size={16} />\r\n                    </button>\r\n                </div>\r\n                <div className=\"flex items-center justify-between px-1\">\r\n                    <span className={`text-[10px] px-2 py-0.5 rounded-full font-bold tracking-wide uppercase ${speakerClass}`}>\r\n                        {fileData.speaker}\r\n                    </span>\r\n                    <span className=\"text-[10px] text-on-surface-variant font-medium opacity-70\">\r\n                        {fileData.url ? 'Previewable' : 'Local'}\r\n                    </span>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Text evidence\r\n    const textData = data as TextEvidenceData;\r\n    return (\r\n        <div className=\"flex flex-col gap-2 group p-3 rounded-xl bg-surface-container-high hover:bg-surface-container-highest transition-all relative\">\r\n            <div className=\"flex gap-2 items-center\">\r\n                <div className=\"flex-1 relative\">\r\n                    <input\r\n                        disabled={disabled}\r\n                        className=\"w-full text-sm border-none bg-transparent text-on-surface focus:outline-none focus:ring-0 placeholder:text-on-surface-variant/50\"\r\n                        value={textData.content}\r\n                        onChange={(e) => onEdit?.(index, e.target.value)}\r\n                    />\r\n                    <button\r\n                        onClick={() => onOpen(`Evidence #${index + 1}`, textData.content, 'text')}\r\n                        className=\"absolute right-0 top-1/2 -translate-y-1/2 text-on-surface-variant hover:text-primary p-1 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                        title=\"View in Window\"\r\n                    >\r\n                        <ImageIcon size={14} />\r\n                    </button>\r\n                </div>\r\n                <button\r\n                    disabled={disabled}\r\n                    onClick={() => onDelete(index, false)}\r\n                    className=\"text-on-surface-variant hover:text-error opacity-0 group-hover:opacity-100 transition-opacity disabled:hidden\"\r\n                >\r\n                    <X size={16} />\r\n                </button>\r\n            </div>\r\n            <div className=\"px-0\">\r\n                <span className={`text-[10px] px-2 py-0.5 rounded-full font-bold tracking-wide uppercase ${speakerClass}`}>\r\n                    {textData.speaker}\r\n                </span>\r\n            </div>\r\n            <div className=\"absolute bottom-0 left-2 right-2 h-0.5 bg-on-surface-variant/10 rounded-full\" />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EvidenceItem;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\components\\WindowFrame.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\ChatArea\\MessageInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\ChatArea\\MessageList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UIRole' is defined but never used.","line":8,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UIRole"},"fix":{"range":[379,387],"text":""},"desc":"Remove unused variable \"UIRole\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useEffect } from 'react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport rehypeSanitize, { defaultSchema } from 'rehype-sanitize';\r\nimport { ShieldCheck } from 'lucide-react';\r\nimport Avatar from '../../components/Avatar';\r\nimport Badge from '../../components/Badge';\r\nimport { getBubbleStyles } from '../../utils/roleStyles';\r\nimport type { Message, UIRole } from '../../types';\r\n\r\n// Sanitization config for ReactMarkdown\r\nconst SANITIZE_CONFIG = {\r\n    ...defaultSchema,\r\n    tagNames: [\r\n        'p', 'b', 'i', 'strong', 'em', 'code', 'pre',\r\n        'ul', 'ol', 'li', 'br', 'blockquote',\r\n        'h1', 'h2', 'h3', 'h4', 'h5', 'h6'\r\n    ],\r\n    attributes: {\r\n        '*': ['className'],\r\n        'code': ['className'],\r\n        'pre': ['className']\r\n    }\r\n};\r\n\r\nexport interface MessageListProps {\r\n    messages: Message[];\r\n    roleFilter: string;\r\n}\r\n\r\n/**\r\n * MessageList - Renders the list of chat messages with auto-scroll.\r\n */\r\nconst MessageList: React.FC<MessageListProps> = ({ messages, roleFilter }) => {\r\n    const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Auto-scroll to bottom on new messages\r\n    useEffect(() => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n    }, [messages]);\r\n\r\n    const filteredMessages = roleFilter === 'all'\r\n        ? messages\r\n        : messages.filter(m => m.role === roleFilter);\r\n\r\n    const showEmptyState = filteredMessages.length === 0;\r\n\r\n    return (\r\n        <div className=\"flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth pb-32\">\r\n            {filteredMessages.map(msg => {\r\n                const isSelf = msg.isSelf || false;\r\n                const bubbleClass = getBubbleStyles(msg.role, isSelf);\r\n\r\n                return (\r\n                    <div\r\n                        key={msg.id}\r\n                        className={`flex gap-4 items-start max-w-3xl group ${isSelf ? 'ml-auto flex-row-reverse' : ''}`}\r\n                    >\r\n                        <Avatar role={msg.role} />\r\n                        <div className={`space-y-1 min-w-0 flex-1 flex flex-col ${isSelf ? 'items-end' : 'items-start'}`}>\r\n                            <div className={`flex items-center gap-2 ${isSelf ? 'flex-row-reverse' : ''} opacity-80`}>\r\n                                <span className=\"font-bold text-on-surface text-sm\">{msg.name}</span>\r\n                                <Badge role={msg.role} />\r\n                                <span className=\"text-[10px] text-on-surface-variant font-medium\">{msg.timestamp}</span>\r\n                            </div>\r\n                            <div className={`text-sm leading-relaxed px-5 py-3.5 shadow-sm ${bubbleClass}\r\n                prose prose-sm max-w-none\r\n                prose-headings:text-inherit prose-p:my-1 prose-ul:my-1 prose-li:my-0.5 prose-strong:text-inherit`}\r\n                            >\r\n                                <ReactMarkdown rehypePlugins={[[rehypeSanitize, SANITIZE_CONFIG]]}>\r\n                                    {msg.content}\r\n                                </ReactMarkdown>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            })}\r\n\r\n            {/* Empty State */}\r\n            {showEmptyState && (\r\n                <div className=\"flex flex-col items-center justify-center p-10 opacity-20 select-none pointer-events-none absolute inset-0\">\r\n                    <div className=\"rounded-full bg-surface-container-highest p-8 mb-4\">\r\n                        <ShieldCheck size={64} className=\"text-on-surface-variant\" strokeWidth={1} />\r\n                    </div>\r\n                    <p className=\"text-lg font-medium text-on-surface-variant\">Ready for Court Session</p>\r\n                </div>\r\n            )}\r\n\r\n            <div ref={messagesEndRef} />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MessageList;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\ChatArea\\index.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UIRole' is defined but never used.","line":5,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UIRole"},"fix":{"range":[208,216],"text":""},"desc":"Remove unused variable \"UIRole\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport MessageList from './MessageList';\r\nimport MessageInput from './MessageInput';\r\nimport DetailedInputWindow from '../../components/DetailedInputWindow';\r\nimport type { Message, UIRole, UserRole, WindowState } from '../../types';\r\n\r\nexport interface ChatAreaProps {\r\n    // Messages\r\n    messages: Message[];\r\n    roleFilter: string;\r\n    onRoleFilterChange: (role: string) => void;\r\n    // Session info\r\n    currentPhase: string;\r\n    currentSpeaker: string;\r\n    sessionId: string | null;\r\n    isConnected: boolean;\r\n    // Input handling\r\n    inputValue: string;\r\n    onInputChange: (value: string) => void;\r\n    onSendMessage: () => void;\r\n    isTurnToSpeak: boolean;\r\n    // Long form mode\r\n    isLongFormMode: boolean;\r\n    onExpandInput: () => void;\r\n    onCloseLongForm: () => void;\r\n    selectedRole: UserRole;\r\n    // Input window\r\n    inputWindowState: WindowState;\r\n    onFocusInputWindow: () => void;\r\n    onUpdateInputWindowPos: (id: string | number, x: number, y: number) => void;\r\n    onUpdateInputWindowSize: (id: string | number, w: number, h: number) => void;\r\n}\r\n\r\n/**\r\n * ChatArea - Main chat section containing header, message list, and input.\r\n * Combines MessageList and MessageInput components.\r\n */\r\nconst ChatArea: React.FC<ChatAreaProps> = ({\r\n    // Messages\r\n    messages,\r\n    roleFilter,\r\n    onRoleFilterChange,\r\n    // Session info\r\n    currentPhase,\r\n    currentSpeaker,\r\n    sessionId,\r\n    isConnected,\r\n    // Input handling\r\n    inputValue,\r\n    onInputChange,\r\n    onSendMessage,\r\n    isTurnToSpeak,\r\n    // Long form mode\r\n    isLongFormMode,\r\n    onExpandInput,\r\n    onCloseLongForm,\r\n    selectedRole,\r\n    // Input window\r\n    inputWindowState,\r\n    onFocusInputWindow,\r\n    onUpdateInputWindowPos,\r\n    onUpdateInputWindowSize\r\n}) => {\r\n    const handleSendAndClose = () => {\r\n        onSendMessage();\r\n        onCloseLongForm();\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex-1 flex flex-col bg-surface-container-lowest min-w-[400px] relative rounded-t-[32px] overflow-hidden mt-2 mx-2 shadow-sm border border-outline-variant/10\">\r\n            {/* Header */}\r\n            <div className=\"h-16 flex items-center justify-between px-6 z-20 bg-surface-container-lowest/80 backdrop-blur-md sticky top-0 border-b border-outline-variant/5\">\r\n                <div className=\"flex items-center gap-6\">\r\n                    {/* Role Filter Tabs */}\r\n                    <div className=\"flex gap-1 bg-surface-container p-1 rounded-full border border-outline-variant/30\">\r\n                        {['all', 'judge', 'prosecutor', 'defense'].map(r => (\r\n                            <button\r\n                                key={r}\r\n                                onClick={() => onRoleFilterChange(r)}\r\n                                className={`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all ${roleFilter === r\r\n                                    ? 'bg-active text-white shadow-sm'\r\n                                    : 'text-on-surface-variant hover:text-on-surface hover:bg-surface-container-highest'\r\n                                    }`}\r\n                            >\r\n                                {r.charAt(0).toUpperCase() + r.slice(1)}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"h-8 w-px bg-outline-variant/30 hidden md:block\" />\r\n\r\n                    {/* Status Info */}\r\n                    <div className=\"hidden md:flex items-center gap-6 text-xs\">\r\n                        <div className=\"flex flex-col\">\r\n                            <span className=\"text-on-surface-variant font-bold uppercase text-[9px] tracking-widest\">Current Phase</span>\r\n                            <span className=\"font-bold text-primary text-sm\">{currentPhase}</span>\r\n                        </div>\r\n                        <div className=\"flex flex-col\">\r\n                            <span className=\"text-on-surface-variant font-bold uppercase text-[9px] tracking-widest\">Speaker</span>\r\n                            <span className=\"font-bold text-primary text-sm\">{currentSpeaker || 'None'}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Session ID */}\r\n                <div className=\"hidden md:flex items-center gap-6 text-xs border-l border-outline-variant/10 pl-6 h-8\">\r\n                    <div className=\"flex flex-col items-end\">\r\n                        <span className=\"text-on-surface-variant font-bold uppercase text-[9px] tracking-widest\">Session ID</span>\r\n                        <span className=\"font-mono text-xs text-on-surface opacity-80 select-all\">\r\n                            {isConnected && sessionId ? sessionId : '未连接'}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Message List */}\r\n            <MessageList messages={messages} roleFilter={roleFilter} />\r\n\r\n            {/* Message Input */}\r\n            <MessageInput\r\n                inputValue={inputValue}\r\n                onInputChange={onInputChange}\r\n                onSendMessage={onSendMessage}\r\n                onExpandInput={onExpandInput}\r\n                isTurnToSpeak={isTurnToSpeak}\r\n                isLongFormMode={isLongFormMode}\r\n            />\r\n\r\n            {/* Detailed Input Window */}\r\n            <DetailedInputWindow\r\n                isOpen={isLongFormMode}\r\n                onClose={onCloseLongForm}\r\n                inputValue={inputValue}\r\n                setInputValue={onInputChange}\r\n                handleSendMessage={handleSendAndClose}\r\n                selectedRole={selectedRole}\r\n                winState={inputWindowState}\r\n                onFocus={onFocusInputWindow}\r\n                updatePosition={onUpdateInputWindowPos}\r\n                updateSize={onUpdateInputWindowSize}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ChatArea;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\LeftSidebar\\index.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'FileEvidence' is defined but never used.","line":10,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileEvidence"},"fix":{"range":[295,314],"text":""},"desc":"Remove unused variable \"FileEvidence\"."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nD:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\LeftSidebar\\index.tsx:202:30\n  200 |                             />\n  201 |                             <input type=\"file\" ref={fileInputRef} className=\"hidden\" onChange={handleFileChange} />\n> 202 |                             <Button disabled={isDisabled} size=\"icon\" variant=\"secondary\" onClick={() => fileInputRef.current?.click()}>\n      |                              ^^^^^^ This component is created during render\n  203 |                                 <Paperclip size={14} />\n  204 |                             </Button>\n  205 |                             <Button\n\nD:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\LeftSidebar\\index.tsx:77:10\n  75 |         disabled?: boolean;\n  76 |         onClick?: () => void;\n> 77 |     }> = ({ children, size = 'md', variant = 'secondary', className = '', ...props }) => {\n     |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 78 |         const baseStyle = \"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50\";\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         const sizes: Record<ButtonSize, string> = { md: \"h-9 px-4 py-2\", sm: \"h-8 px-3 text-xs\", icon: \"h-9 w-9\", xs: \"h-6 px-2 text-[10px]\", lg: \"h-11 px-6 text-base\" };\n     …\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 88 |         return <button className={`${baseStyle} ${sizes[size]} ${variants[variant]} ${className}`} {...props}>{children}</button>;\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 89 |     };\n     | ^^^^^^ The component is created during render here\n  90 |\n  91 |     const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n  92 |         const file = e.target.files?.[0];","line":202,"column":30,"nodeType":null,"endLine":202,"endColumn":36},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nD:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\LeftSidebar\\index.tsx:205:30\n  203 |                                 <Paperclip size={14} />\n  204 |                             </Button>\n> 205 |                             <Button\n      |                              ^^^^^^ This component is created during render\n  206 |                                 disabled={isDisabled}\n  207 |                                 size=\"icon\"\n  208 |                                 variant=\"secondary\"\n\nD:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\LeftSidebar\\index.tsx:77:10\n  75 |         disabled?: boolean;\n  76 |         onClick?: () => void;\n> 77 |     }> = ({ children, size = 'md', variant = 'secondary', className = '', ...props }) => {\n     |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 78 |         const baseStyle = \"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50\";\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         const sizes: Record<ButtonSize, string> = { md: \"h-9 px-4 py-2\", sm: \"h-8 px-3 text-xs\", icon: \"h-9 w-9\", xs: \"h-6 px-2 text-[10px]\", lg: \"h-11 px-6 text-base\" };\n     …\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 88 |         return <button className={`${baseStyle} ${sizes[size]} ${variants[variant]} ${className}`} {...props}>{children}</button>;\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 89 |     };\n     | ^^^^^^ The component is created during render here\n  90 |\n  91 |     const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n  92 |         const file = e.target.files?.[0];","line":205,"column":30,"nodeType":null,"endLine":205,"endColumn":36}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef } from 'react';\r\nimport { Gavel, Terminal, Plus, Paperclip } from 'lucide-react';\r\nimport EvidenceItem from '../../components/EvidenceItem';\r\nimport type {\r\n    LayoutConfig,\r\n    CaseDataConfig,\r\n    EvidenceDataConfig,\r\n    NewEvidenceInputConfig,\r\n    SessionInfoConfig,\r\n    FileEvidence,\r\n    EvidenceType,\r\n    ButtonSize,\r\n    ButtonVariant\r\n} from '../../types';\r\n\r\n/** LeftSidebar component props using grouped config interfaces */\r\nexport interface LeftSidebarProps {\r\n    layout: LayoutConfig;\r\n    caseData: CaseDataConfig;\r\n    evidenceData: EvidenceDataConfig;\r\n    newEvidenceInput: NewEvidenceInputConfig;\r\n    sessionInfo: SessionInfoConfig;\r\n}\r\n\r\n/**\r\n * LeftSidebar - Contains Case Context, Evidence Chain, and System Logs.\r\n * Props are grouped for better organization.\r\n */\r\nconst LeftSidebar: React.FC<LeftSidebarProps> = ({\r\n    // Layout\r\n    layout,\r\n    // Case Context (grouped)\r\n    caseData,\r\n    // Evidence (grouped)\r\n    evidenceData,\r\n    // New Evidence Input (grouped)\r\n    newEvidenceInput,\r\n    // Session State (grouped)\r\n    sessionInfo\r\n}) => {\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    // Destructure grouped props for convenience\r\n    const { width, onStartResize } = layout;\r\n    const { context: caseContext, onChange: onCaseContextChange } = caseData;\r\n    const {\r\n        file: fileEvidence,\r\n        text: textEvidence,\r\n        filter: evidenceFilter,\r\n        onFilterChange: onEvidenceFilterChange,\r\n        onDelete: onDeleteEvidence,\r\n        onOpen: onOpenWindow,\r\n        onTextEdit: onTextEvidenceEdit\r\n    } = evidenceData;\r\n    const {\r\n        value: newEvidenceValue,\r\n        onChange: onNewEvidenceInputChange,\r\n        speaker: newEvidenceSpeaker,\r\n        onSpeakerChange: onNewEvidenceSpeakerChange,\r\n        onAddText: onAddTextEvidence,\r\n        onAddFile: onAddFileEvidence\r\n    } = newEvidenceInput;\r\n    const { isConnected, isTurnToSpeak, logs, selectedRole } = sessionInfo;\r\n\r\n    const isDisabled = isConnected && !isTurnToSpeak;\r\n\r\n    // Button component (inline for now, can be extracted later)\r\n    // NOTE: This shadows the global Button component but we kept it inline as per original file\r\n    // Ideally this should use the shared Button component.\r\n    const Button: React.FC<{\r\n        children: React.ReactNode;\r\n        size?: ButtonSize;\r\n        variant?: ButtonVariant;\r\n        className?: string;\r\n        disabled?: boolean;\r\n        onClick?: () => void;\r\n    }> = ({ children, size = 'md', variant = 'secondary', className = '', ...props }) => {\r\n        const baseStyle = \"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50\";\r\n        const sizes: Record<ButtonSize, string> = { md: \"h-9 px-4 py-2\", sm: \"h-8 px-3 text-xs\", icon: \"h-9 w-9\", xs: \"h-6 px-2 text-[10px]\", lg: \"h-11 px-6 text-base\" };\r\n        const variants: Record<ButtonVariant, string> = {\r\n            primary: \"bg-primary text-on-primary hover:bg-[#6d5e0f] shadow-sm\",\r\n            secondary: \"bg-surface-container text-on-surface hover:bg-surface-container-high\",\r\n            ghost: \"hover:bg-surface-container-high text-on-surface\",\r\n            outline: \"border border-outline bg-transparent hover:bg-surface-container text-on-surface\",\r\n            danger: \"bg-error text-white hover:bg-[#410002]\",\r\n            success: \"bg-[#2e7d32] text-white hover:shadow-md\"\r\n        };\r\n        return <button className={`${baseStyle} ${sizes[size]} ${variants[variant]} ${className}`} {...props}>{children}</button>;\r\n    };\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            const url = URL.createObjectURL(file);\r\n            const type: EvidenceType = file.type.startsWith('image/') ? 'image' : 'file';\r\n            onAddFileEvidence({ speaker: newEvidenceSpeaker, name: file.name, type, url });\r\n            e.target.value = ''; // Reset input\r\n        }\r\n    };\r\n\r\n    const filteredFileEvidence = fileEvidence.filter(f => evidenceFilter === 'all' || f.speaker === evidenceFilter);\r\n    const filteredTextEvidence = textEvidence.filter(t => evidenceFilter === 'all' || t.speaker === evidenceFilter);\r\n\r\n    return (\r\n        <div style={{ width }} className=\"flex flex-col bg-surface-container-low shrink-0 relative z-10 transition-colors duration-300\">\r\n            {/* Header */}\r\n            <div className=\"h-16 flex items-center px-6 font-bold tracking-tight text-primary text-lg\">\r\n                <Gavel className=\"h-6 w-6 mr-3 text-primary\" /> AI Court System\r\n            </div>\r\n\r\n            {/* Main Content */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar\">\r\n                {/* Case Context */}\r\n                <div className=\"space-y-2\">\r\n                    <label className=\"text-xs font-bold text-slate-500 uppercase\">Case Context</label>\r\n                    <textarea\r\n                        className=\"w-full min-h-[100px] rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500/50 resize-none\"\r\n                        value={caseContext}\r\n                        onChange={e => onCaseContextChange(e.target.value)}\r\n                    />\r\n                </div>\r\n\r\n                {/* Evidence Chain */}\r\n                <div className=\"space-y-3\">\r\n                    <div className=\"flex flex-col gap-2\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <label className=\"text-xs font-bold text-slate-500 uppercase\">Evidence Chain</label>\r\n                            <div className=\"flex gap-1 bg-slate-50 p-0.5 rounded border border-slate-100\">\r\n                                {['all', '原告律师', '被告律师'].map(f => (\r\n                                    <button\r\n                                        key={f}\r\n                                        onClick={() => onEvidenceFilterChange(f)}\r\n                                        className={`px-1.5 py-0.5 rounded text-[9px] font-bold uppercase transition-all ${evidenceFilter === f ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}\r\n                                    >\r\n                                        {f === 'all' ? 'All' : f === '原告律师' ? 'Plain' : 'Def'}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* File Evidence List */}\r\n                    <div className=\"space-y-2\">\r\n                        {filteredFileEvidence.map((f, i) => (\r\n                            <EvidenceItem\r\n                                key={`file-${i}`}\r\n                                type=\"file\"\r\n                                data={f}\r\n                                index={i}\r\n                                disabled={isDisabled}\r\n                                onDelete={onDeleteEvidence}\r\n                                onOpen={onOpenWindow}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Text Evidence List */}\r\n                    <div className=\"flex flex-col gap-2\">\r\n                        {filteredTextEvidence.map((t, i) => (\r\n                            <EvidenceItem\r\n                                key={`text-${i}`}\r\n                                type=\"text\"\r\n                                data={t}\r\n                                index={i}\r\n                                disabled={isDisabled}\r\n                                onDelete={onDeleteEvidence}\r\n                                onOpen={onOpenWindow}\r\n                                onEdit={onTextEvidenceEdit}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Add Evidence */}\r\n                    <div className={`space-y-2 transition-opacity ${isDisabled ? 'opacity-50 pointer-events-none' : ''}`}>\r\n                        <div className=\"flex gap-2 items-center\">\r\n                            <select\r\n                                disabled={selectedRole === 'Prosecutor AI' || selectedRole === 'Defense AI'}\r\n                                className=\"text-[10px] h-7 rounded border-slate-200 bg-white disabled:bg-slate-100 disabled:text-slate-500\"\r\n                                value={newEvidenceSpeaker}\r\n                                onChange={e => onNewEvidenceSpeakerChange(e.target.value)}\r\n                            >\r\n                                <option value=\"原告律师\">原告</option>\r\n                                <option value=\"被告律师\">被告</option>\r\n                            </select>\r\n                            <div className=\"flex-1 h-px bg-slate-100\" />\r\n                        </div>\r\n                        <div className=\"flex gap-2 pt-1\">\r\n                            <input\r\n                                disabled={isDisabled}\r\n                                className=\"flex-1 h-8 rounded-md border border-slate-200 px-2 text-sm disabled:cursor-not-allowed\"\r\n                                placeholder=\"New evidence text...\"\r\n                                value={newEvidenceValue}\r\n                                onChange={e => onNewEvidenceInputChange(e.target.value)}\r\n                                onKeyDown={e => {\r\n                                    if (e.key === 'Enter' && newEvidenceValue) {\r\n                                        onAddTextEvidence({ speaker: newEvidenceSpeaker, content: newEvidenceValue });\r\n                                        onNewEvidenceInputChange('');\r\n                                    }\r\n                                }}\r\n                            />\r\n                            <input type=\"file\" ref={fileInputRef} className=\"hidden\" onChange={handleFileChange} />\r\n                            <Button disabled={isDisabled} size=\"icon\" variant=\"secondary\" onClick={() => fileInputRef.current?.click()}>\r\n                                <Paperclip size={14} />\r\n                            </Button>\r\n                            <Button\r\n                                disabled={isDisabled}\r\n                                size=\"icon\"\r\n                                variant=\"secondary\"\r\n                                onClick={() => {\r\n                                    if (newEvidenceValue) {\r\n                                        onAddTextEvidence({ speaker: newEvidenceSpeaker, content: newEvidenceValue });\r\n                                        onNewEvidenceInputChange('');\r\n                                    }\r\n                                }}\r\n                            >\r\n                                <Plus size={14} />\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Logs Panel */}\r\n            <div className=\"h-48 bg-[#3e3b30] text-[#e6e1e5] flex flex-col rounded-t-3xl overflow-hidden shadow-[0_-4px_20px_rgba(0,0,0,0.2)] mt-2 mx-2 mb-0 transition-colors\">\r\n                <div className=\"h-10 px-4 bg-white/5 flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-[#e6e1e5]/60 select-none border-b border-white/10\">\r\n                    <Terminal size={14} /> System Logs\r\n                </div>\r\n                <div className=\"flex-1 overflow-y-auto p-4 font-mono text-[10px] space-y-1.5 custom-scrollbar\">\r\n                    {logs.map((l, i) => (\r\n                        <div key={i} className=\"opacity-70 hover:opacity-100 transition-opacity border-l-2 border-transparent hover:border-primary pl-2\">\r\n                            {l}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Resize Handle */}\r\n            <div\r\n                className=\"absolute top-0 bottom-0 -right-3 w-6 z-50 flex justify-center cursor-col-resize group touch-none\"\r\n                onMouseDown={onStartResize}\r\n            >\r\n                <div className=\"w-1 h-full rounded-full bg-transparent group-hover:bg-[#6d5e0f] transition-colors duration-200 ease-in-out opacity-60\" />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LeftSidebar;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\features\\RightSidebar\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\hooks\\useCourtSession.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\hooks\\useWindowManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\src\\utils\\roleStyles.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Desktop3\\debate_mfxb\\mock-court\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]